# Session 2/1/26

goal : use teenage engineering docs to base the design of the plugins 

Drop the docs in for context then rip this in phases.

This is a fantastic stylistic pivot. Teenage Engineering (TE) is famous for "playful precision"—hiding complex math behind intuitive, almost toy-like graphics (Lego blocks, punch-in icons, pixel art).
Adapting the OP-XY concepts to your "Neon Industrial" aesthetic creates a unique hybrid: "Cyberpunk Engineering." Think high-contrast OLED displays, mechanical keys, and "Step Components" represented as glowing data streams.
Here are the key concepts extracted from the OP-XY documentation and how to implement them in your Rhythm and Melodic engines.

1. Core Concept: "Step Components" (The TE Secret Sauce)
The OP-XY distinguishes itself not just by placing notes, but by modifying how a step behaves. Instead of simple velocity/probability, TE uses "Components" that you drop onto steps.
- For Your Rhythm Engine:
    - "Ramp" (Parameter Slides): Instead of a separate automation lane, allow the user to hold a step and drag up/down to create a "Ramp." This instantly automates pitch (for 808 glides) or filter cutoff for that single step.
    - "Multiply" (Ratcheting): A step component that repeats the note 2, 3, 4, or 8 times within the step duration. Essential for trap hi-hats.
    - "Spark" (Logic): Step probability, but smarter. "Trigger only on the 1st loop," "Trigger every 4th loop," or "Trigger only if the previous step played".
- Implementation Prompt (Data Structure):
    
    > "Update NoteEvent struct. Add a StepComponent enum with values: None, RampUp, RampDown, Multiply2, Multiply3, SparkFirst, SparkRandom. In the audio processor, implement logic to interpret these flags (e.g., if Multiply2 is active, retrigger the sample halfway through the step)."
    > 
1. Core Concept: "The Brain" (Intelligent Transposition)
The OP-XY uses a concept called "Brain" which actively listens to the musical context and transposes tracks to fit the current chord.
- For Your Bass/Melodic Engine:
    - Instead of a static "Scale Lock," implement a "Brain Mode."
    - Logic: If the user plays a chord on the "Melody" plugin, the "Bass" plugin (linked via the shared data we discussed) automatically transposes its sequence to match the root note, without changing the relative pattern.
    - Visual: A dedicated "Brain" icon that lights up when the plugin is "listening" to the other instances.
1. Core Concept: "Punch-In Effects" (Performance FX)
TE workflows rely heavily on "Punch-in" effects—momentary master effects triggered by holding a button.
- For Both Plugins:
    - Add a row of "Performance Glyphs" at the bottom of the UI.
    - Hyper/Loop: Stutters the audio buffer (1/4, 1/8, 1/16 loop).
    - Filter/Sweep: Momentary high-pass or low-pass sweeps.
    - Visual: When clicked, these shouldn't just light up; they should invert the colors of the entire screen or shake the grid (very TE style feedback).
1. Aesthetic & UI: "The TE Look"
TE UI is defined by Monochrome High-Contrast with specific Color Coding.
- The Palette:
    - Background: pure #000000 (OLED Black).
    - Foreground: Sharp White #FFFFFF for text/grid lines.
    - Accents: TE uses RGB/CMYK to denote function.
        - Rhythm: Neon Red/Orange.
        - Bass: Neon Blue.
        - Melody: Neon Green.
- The Art Style:
    - No Skeuomorphism: Remove the "3D metal" look. Go flat, vector-based.
    - Icons over Text: Don't write "Filter." Draw a line sloping down. Don't write "Loop." Draw a circle arrow.
    - Monospaced Fonts: Use a font like Roboto Mono or Space Mono for all text values to give it that "engineering unit" feel.
    Phased Development Plan (TE Upgrade)
    Here is how to feed this to your agent to upgrade your current codebase.
    Phase 1: The "Step Component" Data Structure
    Agent Prompt:

> "I want to implement a 'Step Modifier' system inspired by the Teenage Engineering OP-XY 'Step Components'.
> 
> 1. Data Model Update:
> - In RhythmStructures.h, add an enum class StepModifier { None, Ratchet2, Ratchet4, Glide, SkipCycle, OnlyFirstCycle }.
> - Update the Step struct to include StepModifier modifier.
> 1. Sequencer Logic Update:
> - In PluginProcessor::processBlock:
> - Ratchet Logic: If modifier == Ratchet2, trigger the note at offset 0 and again at samplesPerStep / 2.
> - Logic Gates: If modifier == SkipCycle, check a currentLoopCount variable. If currentLoopCount % 2 == 0, play the note; otherwise, silence it."

Phase 2: The "Punch-In" FX Engine
Agent Prompt:

> "Implement a momentary 'Punch-In' effects system on the master output.
> 
> 1. DSP Class:
> - Create PunchInFX.h.
> - Implement a circular buffer for a 'Stutter/Loop' effect.
> - Implement a state variable filter for 'Sweep'.
> 1. Trigger Logic:
> - These effects should only be active while the parameter is held (Momentary).
> - Add boolean parameters: FX_STUTTER, FX_FILTER_SWEEP, FX_BITCRUSH.
> 1. Signal Flow:
> - Process this after the main sequencer voice rendering but before the final output."

Phase 3: The UI Overhaul (OLED Cyberpunk)
Agent Prompt:

> "Redesign the UI to match a 'High-Contrast Industrial' aesthetic.
> 
> 1. The Grid:
> - Remove the 'Glass' gradients. Make the background solid Black.
> - Draw the step rectangles as sharp outlines (1px thickness).
> - When a step is active, fill it with solid Neon Color (Red for Drums, Blue for Bass).
> 1. The Icons:
> - Replace the 'Knobs' for Cutoff/Resonance with 'Vector Sliders'.
> - Draw simple geometric icons next to them (e.g., a triangle for 'Decay', a sine wave for 'LFO').
> 1. Animation:
> - When a 'Punch-In' effect is active, invert the colors of the entire Grid Component (White background, Black lines) to give visual feedback of the 'System Override'."

Summary of the "TE Vibe"

- Rhythm Engine: Focus on "Step Components" (Ratchets/Probabilities) per step.
- Bass Engine: Focus on "The Brain" (Transposing sequences based on input).
- Visuals: Black background, sharp neon lines, monospaced text, momentary "glitch" animations.
Do you want me to generate the C++ Enum definition for the Step Components to ensure the agent gets the logic right?